-- Demonstration of how to use the <@> operator to compute the distance in miles
-- between two points on the globe.  Cool!

-- Use \i to import this file into psql.

-- Here we define a "schema" where we can put our little example and keep it
-- separate from other things in your database.
-- Notice that the search path includes "public".  That is necessary
-- in order to make the <@> operator work.

DROP SCHEMA IF EXISTS distance cascade;
CREATE SCHEMA distance;
SET search_path TO distance, public;

-- Here we define a table and store locations in it.  (This is the same
-- table definition and data as used in the A2 starter code.)
-- Locations are specified as longitude and latitude (in that order), in degrees.
-- The psql documentation says that "Points are taken as (longitude, latitude) 
-- and not vice versa because longitude is closer to the intuitive idea of x-axis 
-- and latitude to y-axis.

CREATE TABLE Place (
   name varchar(30) PRIMARY KEY,
   location point NOT NULL
) ;

insert into place values
('highclere castle', '(1.361, 51.3267)'),
('dower house', '(-0.4632, 51.3552)'),
('eaton centre', '(79.3803,43.654)'),
('cn tower', '(79.3871,43.6426)'),
('north york civic centre', '(79.4146,43.7673)'),
('pearson international airport', '(79.6306,43.6767)'),
('utsc', '(79.1856,43.7836)');

-- Let's just observe what is in the table.
select * from place;

-- And here's the big punchline:
-- We can use the <@> operator to compare pairs of locations and compute their 
-- distance in miles.  We will use this distance is "as the crow flies",
-- computed without regard to where the streets are, in Assignment 2.
-- Here, we compute that distance between every pair of locations.
select p1.name as start
from place p1
where p1.name not in(
select name
from place
where name='111111111111111111');
